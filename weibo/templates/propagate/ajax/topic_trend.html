{% extends "propagate/base.html" %}
{% block title %}话题传播分析{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="/static/css/jquery-ui.css" />
  <script src="{{ url_for('static', filename='js/jquery-1.8.3.min.js') }}"></script>
  <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}" type="text/javascript"></script>
{% endblock %}
    
{% block content %}
  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span12">
        <div class="caption" style="float:left">
          <div style="float:left">
            {% if topic_profile_image_url %}
            <img style="width: 150px; height: 140px;" type="image/jpg" src="{{ topic_profile_image_url }}" media="screen" />
            {% else %}
            <img style="width: 150px; height: 140px;" type="image/jpg" src="/static/img/topic_none.png" media="screen" />
            {% endif %}
          </div>
          <div style="float:left;padding-left:50px;">
            <h3>话题传播分析:&nbsp&nbsp&nbsp{{ keyword }}</h3>
            <div style="float:left;padding-top:10px;">
              <label style="font-size:18px">开始时间：<span class="badge badge-success" style="font-size:18px"> {{ return_beg_str }} </span> </label>
              <label class="appendedInput" style="font-size:18px;padding-top:10px;">截止时间：<span class="badge badge-success" style="font-size:18px"> {{ return_end_str }} </span></label>
            </div>
            <div style="float:left;padding-top:10px;padding-left:30px;">
              <label style="font-size:18px">发起人：<span class="badge badge-info" style="font-size:18px"> {{ topic_ori_screen_name }} </span> </label>
              <label class="appendedInput" style="font-size:18px;padding-top:10px;">发起时间：<span class="badge badge-info" style="font-size:18px">{{ topic_ori_date }} </span></label>
              
            </div>
            <div style="float:left;padding-top:10px;padding-left:30px;">                
                <label class="appendedInput" style="font-size:18px">原创微博条数：<span class="badge badge-warning" style="font-size:18px"> {{ blog_ori_count }} </span></label>
                <label class="appendedInput" style="font-size:18px;padding-top:10px;">相关微博条数：<span class="badge badge-warning" style="font-size:18px"> {{ blog_rel_count }} </span></label>                
            </div>
            <div style="float:left;padding-top:10px;padding-left:30px;">
              <label class="appendedInput" style="font-size:18px">原创微博比例：{{ blog_ori_account }}</label>
              <!--<label class="appendedInput" style="font-size:18px;padding-top:10px;">领袖人数：{{ topic_leader_count }} </label>-->
            </div>
          </div>
        </div>
      </div>
    </div><!--上侧基本信息-->
          
    <div class="row-fluid" style="padding-top:20px;">
      <div class="span12" id="index-tabs">
        <ul class="nav nav-pills tab_container">
          <li class="btn span2" style="width:150px;height:20px;"><a href="/propagate/topic_ajax_weibos/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">关联微博</a></li>
          <li class="btn span2 btn-primary" style="width:150px;height:20px;"><a href="/propagate/topic_ajax_trend/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">传播数量走势</a></li>
          <li class="btn span2" style="width:150px;height:20px;"><a href="/propagate/topic_ajax_spatial/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">地理分布</a></li>
          <li class="btn span2" style="width:150px;height:20px;"><a href="/propagate/topic_ajax_stat/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">传播指标</a></li>
          <li class="btn span2" style="width:150px;height:20px;"><a href="/propagate/topic_ajax_userfield/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">关键人员统计</a></li>
          <li class="btn span2" style="width:150px;height:20px;"><a href="/gexf/show_forest/?keyword={{keyword}}&time={{dur_time}}" align="center" style="padding-top: 2px;padding-bottom: 2px;color:black;">传播路径</a></li>          
        </ul>
        <div id="content_container">
          <div class="container">
	           <div id="count_chart" style="height: 500px;width: 900px; margin: 0px auto auto 200px;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
{% block script %}
<script src="/static/js/jquery-ui.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/highstock.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/exporting.js') }}"></script>
<script>
  var request_data_dict = {'keyword':'{{keyword}}','time':'{{dur_time}}'};
  $.ajax({
	url:"/propagate/topic_ajax_trend/",
	dataType:"json",
	data: request_data_dict,
	type:"POST",
	success:function(data){
		display_trend_chart(data);
	}
  });
  function display_trend_chart(data){
  	$('#count_chart').highcharts('StockChart', {
		rangeSelector : {
			selected : 1
		},
		title : {
			text : '话题传播趋势'
		},
		series : [{
			name : '微博数量',
			data : data['perday_blog_count'],
			tooltip: {
				valueDecimals: 2
			}
		}]
	});
  }
</script>
{% endblock script %}